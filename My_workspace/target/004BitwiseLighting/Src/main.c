/**
 ******************************************************************************
 * @file           : main.c
 * @author         : Auto-generated by STM32CubeIDE
 * @brief          : Main program body
 ******************************************************************************
 * @attention
 *
 * Copyright (c) 2025 STMicroelectronics.
 * All rights reserved.
 *
 * This software is licensed under terms that can be found in the LICENSE file
 * in the root directory of this software component.
 * If no LICENSE file comes with this software, it is provided AS-IS.
 *
 ******************************************************************************
 */

#include <stdint.h>

#if !defined(__SOFT_FP__) && defined(__ARM_FP)
  #warning "FPU is not initialized, but the project is compiling for an FPU. Please initialize the FPU before use."
#endif

/*
 * Procedure to turn on the LED:
 * 1) Identify GPIO port used to connect the led (GPIO A for nucleo c0)
 * 2) Identify the GPIO pin where the LED is connected (PA5)
 * 3) Activate or turn on the GPIOA peripheral (enable the clock)
 * 4) Configure the GPIO pin mode as output
 * 5) Write to the pin
 */

int main(void)
{
	//RCC base address is 0x40021000 + the address offset for peripheral clock registers (0x34)  =>  0x40021034 (Page 148 for offset)
    //GPIOA mode base register memory address is 0x50000000, reset value is  0xEBFFFFFF (used to control mode, in this case change mode to output) (Page 187 for this info).. every mode has 2 bit positions to set.
	//Address of the GPIOA output data register is 0x50000000 + offset (0x14) => 0x50000014(used to write)

	uint32_t *pClockRegister = (uint32_t *)0x40021034;
	uint32_t *pPortAModeRegister = (uint32_t *)0x50000000;
	uint32_t *pPortAOutputRegister = (uint32_t *)0x50000014;

	//Activate or turn on the GPIOA peripheral (enable the clock), using bitwise,
	//GPIOA is mapped to the first register so we want to simply use 0x00000001 as the mask to set the bit to 1

	uint32_t temp = *pClockRegister; //dereference pointer and store value into temp
	temp = temp | 0x00000001; //Bitwise set operation to set the 0th bit to 1 or on for the RCC
	*pClockRegister = temp; //Write to set on

//	*pClockRegister |= *pClockRegister | 0x00000001 can be written shorthand like this

	//To Configure the GPIO pin mode as output, we first clear both bits then set it to 01 to set to output mode
	//mask value will be 0xFFFFF3FF to clear
	*pPortAModeRegister &= 0xFFFFF3FF;

	//mask value to set will be 0x00000200
	*pPortAModeRegister |= 0x00000400;

	//Set 5th bit of the output data register to make I/O pin as HIGH or on
	//the mask value is 0x00000020
	*pPortAOutputRegister |= 0x0020;


	/* Loop forever */
	while(1){

	}
}
